<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تمرين: التواضع - منصة المبدأ التعليمية</title>
    <link rel="stylesheet" href="../../css/style.css"> <style>
        /* أنماط خاصة بالاختبار لتتناسب مع التنسيق السابق */
        .activity-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 30px;
            background-color: #f9f9f9;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            text-align: right;
            position: relative; /* لإحتواء الأزرار بشكل صحيح */
        }
        .question-box {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 25px;
            margin-bottom: 25px;
            display: none; /* يتم إظهار السؤال الحالي فقط بواسطة JS */
        }
        .question-box.active {
            display: block;
        }
        .question-text {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #34495E;
            font-weight: bold;
        }
        .options label {
            display: block;
            margin-bottom: 15px;
            padding: 15px;
            background-color: #eee;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease, border-color 0.3s ease;
            font-size: 1.1em;
            font-weight: bold;
            border: 2px solid transparent;
        }
        .options label:hover {
            background-color: #e0e0e0;
        }
        .options input[type="radio"] {
            margin-left: 10px;
            transform: scale(1.2);
        }
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 10px; /* مسافة بين الأزرار */
        }
        .navigation-buttons button {
            padding: 12px 25px;
            flex-grow: 1; /* لتوزيع المساحة بالتساوي */
            background-color: #3498DB;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-weight: bold;
        }
        .navigation-buttons button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .navigation-buttons button.check-button {
            background-color: #2ECC71;
        }
        .navigation-buttons button.check-button:hover {
            background-color: #27AE60;
        }
        .navigation-buttons button.submit-button { /* زر إرسال نهائي */
            background-color: #E74C3C;
        }
        .navigation-buttons button.submit-button:hover {
            background-color: #C0392B;
        }
        .feedback-box {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            font-size: 1em;
            display: none; /* مخفي افتراضياً */
        }
        .feedback-box.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #28a745;
        }
        .feedback-box.incorrect {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #dc3545;
        }
        .rationale {
            font-size: 0.9em;
            margin-top: 10px;
            color: #333;
        }
        .hint {
            font-size: 0.9em;
            margin-top: 5px;
            color: #6c757d;
            font-style: italic;
        }
        .correct-answer-highlight {
            border: 2px solid #28a745 !important;
            background-color: #d4edda !important;
        }
        .incorrect-answer-highlight {
            border: 2px solid #dc3545 !important;
            background-color: #f8d7da !important;
        }
        .results-summary {
            margin-top: 30px;
            padding: 20px;
            border-top: 2px solid #3498DB;
            background-color: #e9f5ff;
            border-radius: 8px;
            text-align: center;
            display: none;
        }
        .results-summary h3 {
            color: #34495E;
            font-size: 1.8em;
            margin-bottom: 15px;
        }
        .results-summary p {
            font-size: 1.3em;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .incorrect-questions-list {
            margin-top: 20px;
            border-top: 1px dashed #A9CCE3;
            padding-top: 15px;
            text-align: right;
        }
        .incorrect-questions-list h4 {
            color: #E74C3C;
            font-size: 1.4em;
            margin-bottom: 10px;
        }
        .incorrect-questions-list ul {
            list-style: none;
            padding: 0;
        }
        .incorrect-questions-list li {
            margin-bottom: 10px;
            font-size: 1.1em;
            color: #555;
            line-height: 1.5;
        }
        .restart-button {
            display: block;
            width: 200px;
            padding: 12px;
            margin: 20px auto 0;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .restart-button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>

    <header class="main-header">
        <div class="header-content">
            <div class="header-left">
                <p>مدرسة المبدأ الابتدائية المختلطة</p>
            </div>
            <div class="header-center">
                <h1>منصة المبدأ التعليمية</h1>
                <p class="tagline">المنصة مخصصة لمادة التربية الإسلامية للصف الخامس الابتدائي</p>
            </div>
            <div class="header-right">
                <p>مديرية تربية الرصافة الثالثة</p>
            </div>
        </div>

        <nav class="main-nav">
            <ul>
                <li><a href="../../index.html">الرئيسية</a></li>
                <li><a href="../../units_overview.html">وحدات المادة</a></li>
                <li><a href="../../videos.html">الفيديوهات</a></li>
                <li><a href="../../activities.html" class="active">تمارين تفاعلية</a></li>
                <li><a href="../../about.html">من نحن</a></li>
                <li><a href="../../contact.html">اتصل بنا</a></li>
            </ul>
        </nav>
    </header>

    <main class="main-content lesson-page">
        <h2>تمرين الوحدة الثالثة - الدرس الخامس: التواضع</h2>

        <div class="activity-container">
            <div id="quiz-form">
                </div>

            <div class="navigation-buttons">
                <button id="prev-btn" class="nav-btn">السابق</button>
                <button id="check-btn" class="check-button">تحقق من الإجابة</button>
                <button id="next-btn" class="nav-btn">التالي</button>
            </div>

            <div id="results-summary" class="results-summary">
                <h3>نتائجك</h3>
                <p>عدد الإجابات الصحيحة: <span id="correct-count">0</span> من <span id="total-questions-summary">0</span></p>
                <p>عدد الإجابات الخاطئة: <span id="incorrect-count">0</span></p>
                <div id="incorrect-questions-list" class="incorrect-questions-list">
                    <h4>الأسئلة التي أخطأت فيها:</h4>
                    <ul>
                        </ul>
                </div>
                <button class="restart-button" onclick="restartQuiz()">إعادة الاختبار</button>
            </div>
        </div>

        <div class="lesson-navigation">
            <a href="../../units/unit3/topic5.html">العودة لدرس التواضع</a> <a href="../../activities.html">العودة لفهرس التمارين</a>
        </div>
    </main>

    <footer class="main-footer">
        <p class="designer-info">إعداد وتصميم: مرتضى الخفاجي</p>
    </footer>

    <script>
        const questions = [
            {
                question: "ما هو عنوان الدرس الخامس من الوحدة الثالثة؟",
                options: ["معركة بدر الكبرى", "سورة المعارج", "الحديث الشريف (النهي عن الكذب)", "من الآداب الإسلامية: التواضع"],
                answer: "من الآداب الإسلامية: التواضع",
                rationale: "الدرس الخامس في الوحدة الثالثة يتناول التواضع كأحد الآداب الإسلامية المهمة.",
                hint: "يتعلق بخلق حميد عكس الكبر."
            },
            {
                question: "ماذا يعني التواضع في الإسلام؟",
                options: ["التكبر على الناس", "إذلال النفس أمام الآخرين", "عدم التكبر، معرفة قدر النفس، التعامل بلين مع الناس", "الاستعلاء على الخلق"],
                answer: "عدم التكبر، معرفة قدر النفس، التعامل بلين مع الناس",
                rationale: "التواضع هو لين الجانب، وخفض الجناح للمؤمنين، ومعرفة المرء لقدر نفسه دون تكبر أو استعلاء.",
                hint: "ليس له علاقة بالذل أو الاهانة."
            },
            {
                question: "اذكر آية قرآنية أو حديثاً نبوياً يحث على التواضع.",
                options: ["﴿إِنَّ اللَّهَ لَا يُحِبُّ مَن كَانَ مُخْتَالًا فَخُورًا﴾", "﴿وَاخْفِضْ جَنَاحَكَ لِلْمُؤْمِنِينَ﴾ أو حديث 'ما تواضع أحد لله إلا رفعه الله'", "﴿وَلَا تَمْشِ فِي الْأَرْضِ مَرَحًا﴾", "﴿وَمَن يَتَوَكَّلْ عَلَى اللَّهِ فَهُوَ حَسْبُهُ﴾"],
                answer: "﴿وَاخْفِضْ جَنَاحَكَ لِلْمُؤْمِنِينَ﴾ أو حديث 'ما تواضع أحد لله إلا رفعه الله'",
                rationale: "هذه الآية والحديث من النصوص التي تدعو إلى التواضع وتبرز فضله.",
                hint: "آية من سورة الحجر أو حديث يبدأ بكلمة 'ما تواضع'."
            },
            {
                question: "ما هي الصفة التي تقابل التواضع وتنهى عنها الإسلام؟",
                options: ["الشجاعة", "العدل", "الكبر/الغرور", "الكرم"],
                answer: "الكبر/الغرور",
                rationale: "الكبر هو عكس التواضع، وهو صفة ذميمة ومن صفات إبليس، وقد حذر الإسلام منه بشدة.",
                hint: "هذه الصفة تجعل صاحبها ينظر إلى نفسه أفضل من الآخرين."
            },
            {
                question: "ما هي بعض مظاهر تواضع النبي محمد صلى الله عليه وسلم؟",
                options: ["كان يأمر الناس بخدمته فقط", "كان يجالس الفقراء، يأكل مع المساكين، يخدم نفسه، لا يتعالى على أحد", "كان يركب الخيل الفارهة فقط", "كان يلبس أفخر الثياب فقط"],
                answer: "كان يجالس الفقراء، يأكل مع المساكين، يخدم نفسه، لا يتعالى على أحد",
                rationale: "كان النبي صلى الله عليه وسلم مثالاً للتواضع في كل حياته، يتعامل مع الجميع بكل بساطة ولين.",
                hint: "تذكر مواقفه في التعامل مع الناس والمهام اليومية."
            },
            {
                question: "ما فوائد التواضع على الفرد والمجتمع؟",
                options: ["جلب العداوة والبغضاء", "يكسب محبة الله والناس، يؤدي إلى الألفة والمودة، يزيل البغضاء", "يزيد من الخلافات", "يؤدي إلى العزلة"],
                answer: "يكسب محبة الله والناس، يؤدي إلى الألفة والمودة، يزيل البغضاء",
                rationale: "التواضع يجلب الخير والبركة والمحبة، ويبني مجتمعاً متماسكاً خالياً من التكبر والحسد.",
                hint: "فوائد إيجابية على العلاقات الإنسانية والرضا الإلهي."
            },
            {
                question: "لماذا يجب على المسلم أن يكون متواضعاً؟",
                options: ["لكي يرى الناس أنه ضعيف", "لأنه لا يملك شيئاً يفتخر به", "اقتداءً بالنبي، لأنه صفة يحبها الله، وللتجنب الكبر", "لأن التكبر يجعله وحيداً"],
                answer: "اقتداءً بالنبي، لأنه صفة يحبها الله، وللتجنب الكبر",
                rationale: "التواضع من الأخلاق الإسلامية الرفيعة التي أمر الله بها وحث عليها نبيه، وهو طريق للتقرب إلى الله والفوز بالجنة.",
                hint: "تذكر الأجر والثواب ومثال النبي."
            },
            {
                question: "هل التواضع يعني إهانة النفس؟ ولماذا؟",
                options: ["نعم، التواضع هو إذلال النفس", "لا، التواضع هو معرفة قدر النفس دون تكبر أو تعالٍ، وليس إذلالاً للنفس", "أحياناً يكون كذلك", "لا علاقة له بإهانة النفس"],
                answer: "لا، التواضع هو معرفة قدر النفس دون تكبر أو تعالٍ، وليس إذلالاً للنفس",
                rationale: "التواضع هو عدم التعالي على الناس، والتعامل معهم باحترام، مع حفظ كرامة النفس وعزتها.",
                hint: "لا يخل بالكرامة."
            },
            {
                question: "كيف يمكن للمسلم أن ينمي صفة التواضع في نفسه؟",
                options: ["بالتفاخر بما يملك", "بالنظر إلى من هو أدنى منه", "بالتأمل في عظمة الله، وتذكر أن كل نعمة من الله، وخدمة الآخرين", "بالابتعاد عن الناس"],
                answer: "بالتأمل في عظمة الله، وتذكر أن كل نعمة من الله، وخدمة الآخرين",
                rationale: "تذكر عظمة الخالق يكسر الكبر في النفس، والاعتراف بأن كل النعم من الله يورث الشكر والتواضع، وخدمة الآخرين تهذب النفس.",
                hint: "تذكر المصدر الحقيقي للنعم، والتعامل مع الناس."
            },
            {
                question: "اذكر موقفاً من حياة النبي صلى الله عليه وسلم يدل على تواضعه.",
                options: ["كان يجلس على عرش مرتفع دائماً", "كان يرفض مساعدة أي شخص", "كان يشارك الصحابة في حفر الخندق، أو كان يرفض أن يقوم له الناس", "كان يأمر الناس بتقبيل يده دائماً"],
                answer: "كان يشارك الصحابة في حفر الخندق، أو كان يرفض أن يقوم له الناس",
                rationale: "كان النبي صلى الله عليه وسلم يعمل بيده مع أصحابه، ولا يحب أن يقوم له أحد، وهو أسمى مراتب التواضع.",
                hint: "مثال على عمل يدوي جماعي أو رفضه مظاهر التبجيل الزائدة."
            }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let userChoices = new Array(questions.length).fill(null); // To store selected option value
        let questionAnsweredCorrectly = new Array(questions.length).fill(false); // To track if question was answered correctly

        const quizForm = document.getElementById('quiz-form');
        const prevBtn = document.getElementById('prev-btn');
        const checkBtn = document.getElementById('check-btn');
        const nextBtn = document.getElementById('next-btn');
        const resultsSummary = document.getElementById('results-summary');
        const correctCountSpan = document.getElementById('correct-count');
        const incorrectCountSpan = document.getElementById('incorrect-count');
        const totalQuestionsSummarySpan = document.getElementById('total-questions-summary');
        const incorrectQuestionsList = document.querySelector('#incorrect-questions-list ul');

        totalQuestionsSummarySpan.textContent = questions.length;

        function renderQuestion(index) {
            quizForm.innerHTML = ''; // Clear previous question
            const qData = questions[index];

            const questionBox = document.createElement('div');
            questionBox.className = 'question-box active';
            questionBox.innerHTML = `
                <div class="question-text">${index + 1}. ${qData.question}</div>
                <div class="options" id="options-${index}"></div>
                <div class="feedback-box" id="feedback-${index}">
                    <p id="feedback-text-${index}"></p>
                    <p class="rationale" id="rationale-text-${index}"></p>
                    <p class="hint" id="hint-text-${index}"></p>
                </div>
            `;
            quizForm.appendChild(questionBox);

            const optionsContainer = document.getElementById(`options-${index}`);
            // Shuffle options to prevent memorization by position
            const shuffledOptions = [...qData.options].sort(() => Math.random() - 0.5);

            shuffledOptions.forEach((optionText, optIndex) => {
                const label = document.createElement('label');
                label.innerHTML = `
                    <input type="radio" name="q${index}" value="${optionText}" data-question-index="${index}">
                    ${optionText}
                `;
                label.onclick = () => selectOption(index, optionText, label);
                optionsContainer.appendChild(label);

                // Restore selected choice if already made
                if (userChoices[index] === optionText) {
                    label.classList.add('selected');
                    label.querySelector('input[type="radio"]').checked = true;
                }
            });

            // If question was already checked, show feedback and disable options
            if (questionAnsweredCorrectly[index] || userChoices[index] !== null) {
                displayFeedback(index, true);
                disableOptions(index);
                checkBtn.disabled = true;
            } else {
                checkBtn.disabled = true; // Initially disable check button
                // If user already made a choice on a previous visit to this question, enable check button
                if (userChoices[index] !== null) {
                    checkBtn.disabled = false;
                }
            }
            updateNavigationButtons();
        }

        function selectOption(qIndex, selectedValue, selectedLabel) {
            userChoices[qIndex] = selectedValue;
            const optionsDiv = document.getElementById(`options-${qIndex}`);
            optionsDiv.querySelectorAll('label').forEach(label => {
                label.classList.remove('selected', 'correct-answer-highlight', 'incorrect-answer-highlight');
            });
            selectedLabel.classList.add('selected');

            // Hide feedback when a new option is selected
            document.getElementById(`feedback-${qIndex}`).style.display = 'none';
            checkBtn.disabled = false; // Enable check button when an option is selected
        }

        function checkAnswer() {
            const qData = questions[currentQuestionIndex];
            const selectedValue = userChoices[currentQuestionIndex];
            const feedbackBox = document.getElementById(`feedback-${currentQuestionIndex}`);
            const feedbackTextElem = document.getElementById(`feedback-text-${currentQuestionIndex}`);
            const rationaleTextElem = document.getElementById(`rationale-text-${currentQuestionIndex}`);
            const hintTextElem = document.getElementById(`hint-text-${currentQuestionIndex}`);
            const optionsDiv = document.getElementById(`options-${currentQuestionIndex}`);

            // Clear previous highlights
            optionsDiv.querySelectorAll('label').forEach(label => {
                label.classList.remove('correct-answer-highlight', 'incorrect-answer-highlight');
            });

            if (selectedValue === null) {
                feedbackBox.style.display = 'block';
                feedbackBox.className = 'feedback-box incorrect';
                feedbackTextElem.textContent = 'الرجاء اختيار إجابة.';
                rationaleTextElem.textContent = '';
                hintTextElem.textContent = '';
                return;
            }

            // Highlight selected option
            optionsDiv.querySelectorAll(`input[value="${selectedValue}"]`).forEach(input => {
                input.closest('label').classList.add('selected');
            });

            if (selectedValue === qData.answer) {
                feedbackBox.className = 'feedback-box correct';
                feedbackTextElem.textContent = 'إجابة صحيحة!';
                if (!questionAnsweredCorrectly[currentQuestionIndex]) { // Only increment score if not already correct
                    score++;
                    questionAnsweredCorrectly[currentQuestionIndex] = true;
                }
                optionsDiv.querySelectorAll(`input[value="${selectedValue}"]`).forEach(input => {
                    input.closest('label').classList.add('correct-answer-highlight');
                });
            } else {
                feedbackBox.className = 'feedback-box incorrect';
                feedbackTextElem.textContent = `إجابة خاطئة. الإجابة الصحيحة هي: ${qData.answer}`;
                // Highlight incorrect selected option
                optionsDiv.querySelectorAll(`input[value="${selectedValue}"]`).forEach(input => {
                    input.closest('label').classList.add('incorrect-answer-highlight');
                });
                // Highlight correct option
                optionsDiv.querySelectorAll(`input[value="${qData.answer}"]`).forEach(input => {
                    input.closest('label').classList.add('correct-answer-highlight');
                });
            }

            rationaleTextElem.textContent = `الشرح: ${qData.rationale}`;
            hintTextElem.textContent = `تلميح: ${qData.hint}`;
            feedbackBox.style.display = 'block';

            disableOptions(currentQuestionIndex);
            checkBtn.disabled = true; // Disable after checking
        }

        function disableOptions(qIndex) {
            document.getElementById(`options-${qIndex}`).querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.disabled = true;
            });
        }

        function displayFeedback(qIndex, isChecked) {
            const feedbackBox = document.getElementById(`feedback-${qIndex}`);
            const feedbackTextElem = document.getElementById(`feedback-text-${qIndex}`);
            const rationaleTextElem = document.getElementById(`rationale-text-${qIndex}`);
            const hintTextElem = document.getElementById(`hint-text-${qIndex}`);
            const qData = questions[qIndex];
            const selectedValue = userChoices[qIndex];
            const optionsDiv = document.getElementById(`options-${qIndex}`);

            // Clear previous highlights
            optionsDiv.querySelectorAll('label').forEach(label => {
                label.classList.remove('correct-answer-highlight', 'incorrect-answer-highlight');
            });

            if (isChecked && selectedValue !== null) {
                feedbackBox.style.display = 'block';
                if (selectedValue === qData.answer) {
                    feedbackBox.className = 'feedback-box correct';
                    feedbackTextElem.textContent = 'إجابة صحيحة!';
                    optionsDiv.querySelectorAll(`input[value="${selectedValue}"]`).forEach(input => {
                        input.closest('label').classList.add('correct-answer-highlight');
                    });
                } else {
                    feedbackBox.className = 'feedback-box incorrect';
                    feedbackTextElem.textContent = `إجابة خاطئة. الإجابة الصحيحة هي: ${qData.answer}`;
                    optionsDiv.querySelectorAll(`input[value="${selectedValue}"]`).forEach(input => {
                        input.closest('label').classList.add('incorrect-answer-highlight');
                    });
                    optionsDiv.querySelectorAll(`input[value="${qData.answer}"]`).forEach(input => {
                        input.closest('label').classList.add('correct-answer-highlight');
                    });
                }
                rationaleTextElem.textContent = `الشرح: ${qData.rationale}`;
                hintTextElem.textContent = `تلميح: ${qData.hint}`;
            } else {
                feedbackBox.style.display = 'none';
            }
        }


        function updateNavigationButtons() {
            prevBtn.disabled = currentQuestionIndex === 0;
            if (currentQuestionIndex === questions.length - 1) {
                nextBtn.textContent = 'عرض النتائج';
                nextBtn.classList.add('submit-button');
                nextBtn.classList.remove('nav-btn');
            } else {
                nextBtn.textContent = 'التالي';
                nextBtn.classList.remove('submit-button');
                nextBtn.classList.add('nav-btn');
            }
        }

        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                renderQuestion(currentQuestionIndex);
            } else {
                showResults();
            }
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuestion(currentQuestionIndex);
            }
        }

        function showResults() {
            quizForm.style.display = 'none';
            document.querySelector('.navigation-buttons').style.display = 'none';

            let finalCorrectCount = 0;
            let finalIncorrectCount = 0;
            incorrectQuestionsList.innerHTML = ''; // Clear previous list

            questions.forEach((qData, index) => {
                const selectedValue = userChoices[index];
                if (selectedValue === qData.answer) {
                    finalCorrectCount++;
                } else {
                    finalIncorrectCount++;
                    const listItem = document.createElement('li');
                    listItem.innerHTML = `السؤال رقم ${index + 1}: ${qData.question} <br> (الإجابة الصحيحة: <strong>${qData.answer}</strong>)`;
                    incorrectQuestionsList.appendChild(listItem);
                }
            });

            correctCountSpan.textContent = finalCorrectCount;
            incorrectCountSpan.textContent = finalIncorrectCount;
            resultsSummary.style.display = 'block';
            window.scrollTo(0, document.body.scrollHeight); // Scroll to results
        }

        function restartQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            userChoices.fill(null);
            questionAnsweredCorrectly.fill(false);
            resultsSummary.style.display = 'none';
            quizForm.style.display = 'block';
            document.querySelector('.navigation-buttons').style.display = 'flex';
            renderQuestion(currentQuestionIndex);
        }

        // Initialize quiz
        renderQuestion(currentQuestionIndex);

        // Event Listeners for navigation and check
        prevBtn.addEventListener('click', prevQuestion);
        nextBtn.addEventListener('click', nextQuestion);
        checkBtn.addEventListener('click', checkAnswer);

    </script>
</body>
</html>